<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.zzu.demo.dao.PersonMapper">
    <sql id="colums">
        select * from person
    </sql>

    <insert id="testInsert">
        insert into person values(#{id},#{myName},#{myAge},#{email},#{version},#{flag})
    </insert>

    <select id="listByIds" resultType="com.zzu.demo.entity.Person">
        select * from person
       <where>
            <if test="ids.length>0">
                id in
            </if>
            <foreach collection="ids" item="id" separator="," open="(" close=")">
                #{id}
            </foreach>
       </where>
    </select>

    <select id="selectByPerson" resultType="com.zzu.demo.entity.Person">
        <include refid="colums"/>/*复用sql代码*/
        <choose>
            <when test="id==2">
                where id=2
            </when>
            <when test="id==3">
                where id=3
            </when>
            <otherwise>
                where id is not null
            </otherwise>
        </choose>
    </select>

    <insert id="insertPerson" parameterType="com.zzu.demo.entity.Person">
        insert into person
        <trim prefix="(" suffix=")"  suffixOverrides=",">
            <if test="name!=null">
                name,
            </if>
            <if test="age!=null">
                age,
            </if>
            <if test="email!=null">
                email
            </if>
        </trim>
        <trim prefix="values(" suffix=")" suffixOverrides=",">
            <if test="name!=null">
                #{name},
            </if>
            <if test="age!=null">
                #{age},
            </if>
            <if test="email!=null">
                #{email}
            </if>
        </trim>
    </insert>

    <update id="updatePerson">
        update person
        <set>
            <if test="name!=null">
                name = #{name},
            </if>
            <if test="age!=null">
                age = #{age},
            </if>
            <if test="email!=null">
                email = #{email}
            </if>
        </set>
        <where>
            <if test="id!=null">
                id = #{id}
            </if>
        </where>
    </update>
</mapper>
